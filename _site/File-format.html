<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>Map Manager : File format</title>
        <meta name="description" content="">

        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/mapmanager/css/syntax.css">
        <link rel="stylesheet" href="/mapmanager/css/main.css">
    </head>
    <body>

        <div class="container">
            <div class=row-fluid>
                <div id=header class=span12>
                    <div class=no-print>
<h4><a class=brand href="/mapmanager/">Map Manager</a>
    <small></small>
</h4>

<!--
<div float=right>
<a href="javascript:window.print()" float=right>print</a>
</div>
-->

</div>

                </div>
            </div>

            <div class=row-fluid>
                
                
                    <div id=navigation class=span2>
                        <ul class="nav nav-list">
    <!-- <li><a href="/mapmanager/">Home</a></li> -->
    <BR>
    
    <li class=nav-header><A HREF="search.html">Search ...</A></li>
    
    
        
        

        
            
                <li class=nav-header>Workflows</li>
            
            <li data-order="5"><a href="/mapmanager/gallery">Gallery</a></li>
        
            
            <li data-order="1"><a href="/mapmanager/getting-started">Getting started</a></li>
        
            
            <li data-order="2"><a href="/mapmanager/making-a-map">Making a map</a></li>
        
            
            <li data-order="3"><a href="/mapmanager/annotating-a-stack">Annotating a stack</a></li>
        
            
            <li data-order="1"><a href="/mapmanager/simple-stack-db">Simple stack database</a></li>
        
    
        
        

        
            
                <li class=nav-header>Imaging Core</li>
            
            <li data-order="3"><a href="/mapmanager/stackdb-plot">Stack DB plot</a></li>
        
            
            <li data-order="4"><a href="/mapmanager/scale-panel">Scale panel</a></li>
        
            
            <li data-order="3"><a href="/mapmanager/process-panel">Process panel</a></li>
        
            
            <li data-order="1"><a href="/mapmanager/stack-browser">Stack Browser</a></li>
        
            
            <li data-order="2"><a href="/mapmanager/stack">Stack</a></li>
        
    
        
        

        
            
                <li class=nav-header>Interface Windows</li>
            
            <li data-order="4"><a href="/mapmanager/find-points-panel">Find Points</a></li>
        
            
            <li data-order="6"><a href="/mapmanager/hdd-paths">Hard Drive Paths</a></li>
        
            
            <li data-order="5"><a href="/mapmanager/stackdb-options-panel">Options</a></li>
        
            
            <li data-order="2"><a href="/mapmanager/search-panel">Search panel</a></li>
        
            
            <li data-order="3"><a href="/mapmanager/plot-panel">Plot panel</a></li>
        
            
            <li data-order="1"><a href="/mapmanager/main-panel">Main panel</a></li>
        
    
        
        

        
            
                <li class=nav-header>Plots</li>
            
            <li data-order="1"><a href="/mapmanager/stack-plot">Stack plot</a></li>
        
            
            <li data-order="3"><a href="/mapmanager/run-plot">Run plot</a></li>
        
            
            <li data-order="2"><a href="/mapmanager/map-plot">Map plot</a></li>
        
    
        
        

        
            
                <li class=nav-header>Analysis</li>
            
            <li data-order="1"><a href="/mapmanager/spine-dynamics">Spine Dynamics</a></li>
        
            
            <li data-order="2"><a href="/mapmanager/intensity">Intensity</a></li>
        
    
        
        

        
            
                <li class=nav-header>Blog Posts</li>
            
            <li data-order="2"><a href="/mapmanager/faq">FAQ</a></li>
        
            
            <li data-order=""><a href="/mapmanager/File-format">File format</a></li>
        
            
            <li data-order=""><a href="/mapmanager/fitting-segments-in-fiji">Fitting segments in Fiji</a></li>
        
            
            <li data-order="3"><a href="/mapmanager/user-files">User files</a></li>
        
            
            <li data-order="3"><a href="/mapmanager/database-overview">Database overview</a></li>
        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class=divider></li> first to break up the content. -->
</ul>

                    </div>

                    <div id=content class=span10>
                        <div class=page-header>
    <h3>File format
        
    </h3>
</div>

<p>Map Manager 3 can save two different types of files</p>

<ul>
  <li>Text - Default</li>
  <li>HDF5 - Experimental</li>
</ul>

<h3 id="text">Text</h3>

<h4 id="python">Python</h4>

<p>Map Manager saves files as plain text. Thus, it is relatively easy to extend the function of Map Manager by writing Python (or Matlab) code to load, parse, and analyze these text files. This is a very rapid and effective route to extending the functions of Map Manager with new analysis particular to your own data and ideas. Please have a look at an <a href="https://github.com/cudmore/mapmanager/blob/gh-pages/_notebooks/MapManager.ipynb">example iPython notebook</a>. If you are interested in more information, please email Robert Cudmore.</p>

<p>It is suggested that you use the <a href="https://store.continuum.io/cshop/anaconda/">Anaconda</a> python distribution as it comes with many useful packages pre-installed. Download Anaconda it <a href="http://continuum.io/downloads">here</a>.</p>

<h3 id="hdf5">HDF5</h3>

<p><a href="https://www.hdfgroup.org/HDF5/">HDF5</a> is an open source cross platform binary file format. It can be read from <a href="http://www.mathworks.com/help/matlab/hdf5-files.html">Matlab</a>, <a href="http://www.h5py.org">Python</a>, <a href="http://www.wavemetrics.com/products/igorpro/dataaccess/hdf5.htm">Igor Pro</a> and from a <a href="https://www.hdfgroup.org/products/hdf5_tools/# h5dist">command line</a>.</p>

<p>As of Sept 2015, Map Manager is not saving files in the HDF5 format. If you are interested in turning on this feature, please email Robert Cudmore.</p>

<h4 id="python-1">Python</h4>

<p>It is suggested that you use the <a href="https://store.continuum.io/cshop/anaconda/">Anaconda</a> python distribution as it comes with many useful packages pre-installed including hdf5 for python. Download Anaconda it <a href="http://continuum.io/downloads">here</a>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import h5py
import numpy as np

# open h5 file
f = h5py.File('a5n.hdf5', 'r')

# get list of top level groups (these are mm3 maps)
for g in f:
    print g
    
# assign myMap to top level map
for myMap in f: print myMap

# get list of objects within a map
# these objects include {objmap, stackdb, int, line, linedb}
# keys() returns a list [0], [1], [2], ...
for key in f[myMap].keys():
    print key
    
# datasets within group 'a104'
for ds in f[myMap].values():
    print ds
    

# get an object
objectIndex = 4
f[myMap].values()[objectIndex][:][:]

# get the value of a spine from an object
objectIndex = 4
spineIndex = 10
f[myMap].values()[objectIndex][spineIndex]

# attributes of a dataset
objectIndex= 4
for a in f[myMap].values()[objectIndex].attrs:
    print a

# this is trying to pull form an intensity object
# for some reaosn i can't transpose the rows
f[myMap].values()[9].values()[0][0][:]

# spine 0, spineLen2 (spineLen2 is in column 1)
f[myMap].values()[9].values()[0][0][1]

# spine 1, spineLen2
f[myMap].values()[9].values()[0][1][1]
</code></pre>
</div>

<p>In [64]: f[myMap].values()<a href="https://github.com/cudmore/mapmanager/blob/gh-pages/_notebooks/MapManager.ipynb">9</a>.values()
Out[64]: 
[&lt;HDF5 dataset “a5n_s0_Int1”: shape (385, 41), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s0_Int2”: shape (385, 41), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s0_db2”: shape (385, 44), type “|O8”&gt;,
 &lt;HDF5 dataset “a5n_s0_l”: shape (3903, 19), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s1_Int1”: shape (378, 41), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s1_Int2”: shape (378, 41), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s1_db2”: shape (378, 44), type “|O8”&gt;,
 &lt;HDF5 dataset “a5n_s1_l”: shape (3871, 19), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s2_Int1”: shape (369, 41), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s2_Int2”: shape (369, 41), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s2_db2”: shape (369, 44), type “|O8”&gt;,
 &lt;HDF5 dataset “a5n_s2_l”: shape (3742, 19), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s3_Int1”: shape (364, 41), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s3_Int2”: shape (364, 41), type “&lt;f4”&gt;,
 &lt;HDF5 dataset “a5n_s3_db2”: shape (364, 44), type “|O8”&gt;,
 &lt;HDF5 dataset “a5n_s3_l”: shape (3837, 19), type “&lt;f4”&gt;]</p>

<p>i got 385 from shape (how do i do this with code?)</p>

<p>In [82]: for a in range(385):
    print f[myMap].values()<a href="https://github.com/cudmore/mapmanager/blob/gh-pages/_notebooks/MapManager.ipynb">9</a>.values()[0]<a href="https://www.hdfgroup.org/HDF5/">a</a></p>

<h3 id="this-is-working">this is working</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>mya=np.arange(385, dtype=np.float32)
for a in range(385):
    mya[a] = f[myMap].values()[9].values()[0][a][1]

import matplotlib.pyplot as plt
plt.plot(mya, 'ro')
plt.xlabel('Spine Index')
plt.ylabel('Spine Length 2D (um)')
plt.show()
</code></pre>
</div>

<h4 id="use-the-python-hdf5manager">Use the Python hdf5Manager</h4>

<p>For now this is not very useful for my hdf5 files but is a proof of concept.</p>

<ol>
  <li>
    <p>Download hdf5 manager <a href="https://github.com/mgraupe/hdf5Manager">here</a>.</p>
  </li>
  <li>
    <p>Run it</p>

    <p>python h5_manager.py</p>
  </li>
  <li>
    <p>Getting h5_manager to work</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> # install pyqt4 in anaconda
 conda install pyqt
 # update anaconda (h5_manager was failing to import matplotlib)
 conda update --prefix /Users/cudmore/anaconda anaconda
 # run h5_manager
 python h5_manager.py 
</code></pre>
    </div>
  </li>
</ol>



<div class="post-tags">
  
  
  
    <b>Tags:</b>  
  
  
  
    <a href="/mapmanager/tags/#xxx">xxx</a>
  

   <!--
   <a href="javascript:window.print()">print</a>
    -->

   <!--
   <BR>
   <a href="_posts/2015-05-28-File-format.pdf">print pdf</a>
   <BR>
   -->
    
</div>


                    </div>
                
            </div>

            

            <div class=row-fluid>
                <div id=footer class=span12>
                      Copyright &copy; 2016 - Robert Cudmore -

 <a href="http://robertcudmore.org/index.html">robertcudmore.org</a>

<!--
Documentation for <a href="https://github.com/cudmore/mapmanager">Map Manager</a>
-->
                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                //20160327 removed, this was no doing anything???
                //for (var i = 0; i < sections.length; i++) {
                 //   section = sections[i];
                 //   console.log(section);
                 //   list = lists[section].sort(function(a, b) {
                 //       return a[0] - b[0];
                 //   });

                 //   if (header = headers[section]) {
                 //       navUl.appendChild(header);
                 //   }
                 //   for (var j = 0; j < list.length; j++) {
                 //       navUl.appendChild(list[j][1]);
                 //   }
                //}
            }

            if (document.querySelectorAll) orderNav();
        </script>
        
    </body>
</html>
